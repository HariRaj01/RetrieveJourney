
<!DOCTYPE html>
<html>
<head>
  <script
      src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.0/axios.min.js"
      integrity="sha512-DZqqY3PiOvTP9HkjIWgjO6ouCbq+dxqWoJZ/Q+zPYNHmlnI2dQnbJ5bxAHpAMw+LXRm4D72EIRXzvcHQtE8/VQ=="
      crossorigin="anonymous"
    ></script>
    <title>OutPut Page </title>
    <!-- <script src="/src/SfmcApiHelper.ts"></script> -->
    <button type="button" id="btnGetOauthToken" class="btn btn-primary"
    onclick="getOAuthAccessToken()">GET ACCESS TOKEN</button>
    <!-- <p id="demo" style="color:green;"></p>
    <p id="demo1" style="color:red;"></p>
    <body>
      <h3>Enter Dataextension Name</h3>
      <input type="text" id="txt"/>
      <input type="submit" id="btSubmit"  onclick="creatingDomainConfigurationDE()" disabled />
      <p id="demo2" style="color:green;"></p>
      <p id="demo4" style="color:rgb(13, 0, 128);"></p>
    <p id="demo3" style="color:red;"></p>
  </body> -->
    <br><br>
    
</head>
<body>
  <script>
   const queryString = window.location.search;
    const urlParams = new URLSearchParams(queryString);
    const authorization_code = urlParams.get('code');
    console.log("authorization_code",authorization_code);
    // const tssd = urlParams.get('tssd');
    const tssd ="mcj6cy1x9m-t5h5tz0bfsyqj38ky";

    console.log("tssd=",tssd);
      function getOAuthAccessToken(req,res) {
        
        axios({
          method: "POST",
          url: "/appdemoauthtoken",
          data: {
            authorization_code:authorization_code,
            tssd: tssd
          },
        })
          .then(function (response) {
            console.log(
              "accesstokengeneration:" +
                JSON.stringify(response.data.refreshToken)
            );
            
          })
          .catch(function (error) {
            console.log(error);
          });
      }

//   function dataFolderCheck(per) {
//     console.log("DataFolder SOAP:",JSON.stringify(per.soap_instance_url))
//         axios({
//           method: "POST",
//           url: "/datafoldercheck",
//           data: {
//             // refreshToken: refreshToken, 
//             //memberid: memberid,
//             //restInstance: restInstance,
//             soap_instance_url:per.soap_instance_url,
//           },
//         })
//           .then(function (response) {
//             console.log("datafolder:" + JSON.stringify(response.data));
//             if (response.data.statusText) {
//               // console.log("memberid:" + thisdata.member_id);
//               // console.log("refreshToken:" + thisdata.refreshtoken);
//               // console.log("restInstance:" + thisdata.restInstance);
//               // console.log("soapInstance:" + thisdata.soapInstance);

//               // thisdata.setState({ refreshtoken: response.data.refreshToken });
//               // thisdata.setState({ FolderID: response.data.FolderID });
//               domainConfigurationDECheck(
//                 check={
//                 // refreshToken : response.data.refreshToken,
//                 soap_instance_url : response.data.soap_instance_url,
//                // member_id : response.data.member_id,
//                 Folder_ID : response.data.FolderID
//                 }
//               );
//             } else {
//               retrievingDataExtensionFolderID(
//                 // response.data.refreshToken,
//                 response.data.soap_instance_url,
//               //  response.data.member_id
//               );
//             }
//           })
//           .catch(function (error) {
//             console.log(error);
//           });
//       }

//       function retrievingDataExtensionFolderID(
//         // refreshToken,
//         soap_instance_url,
//        // memberid
//       ) {
//         axios({
//           method: "POST",
//           url: "/retrievingdataextensionfolderid",
//           data: {
//             // refreshToken: refreshToken,
//            // memberid: memberid,
//             soap_instance_url: soap_instance_url,
//           },
//         })
//           .then(function (response) {
//             if (response.data.statusText) {
              
//               console.log(
//                 "retrievingdataextensionfolderid:" +
//                   JSON.stringify(response.data)
//               );
//               // thisdata.setState({ refreshtoken: response.data.refreshToken });
//               createSparkpostIntegrationFolder(
//                params={
//                // refreshToken : response.data.refreshToken,
//                 soap_instance_url : response.data.soap_instance_url,
//                 //member_id : response.data.member_id,
//                 ParentFolderID : response.data.ParentFolderID
//                } 
//               );
//               console.log("Folder ID:",response.data.ParentFolderID)
//             } else {
//               console.log("Error getting Data extension's folder ID");
//             }
//           })
//           .catch(function (error) {
//             console.log(error);
//           });
//       }

//       // creating Sparkpost Integration Data folder
//       function createSparkpostIntegrationFolder(params) {
//         console.log("sparkpost integretion",JSON.stringify(params.ParentFolderID));
//         axios({
//           method: "POST",
//           url: "/createsparkpostintegrationfolder",
//           data: {
//              // accessToken:response.oauthAccessToken,
//              soap_instance_url :params.soap_instance_url,
//              ParentFolderID:params.ParentFolderID
//           }
//         })
//           .then(function (response) {
//             console.log(
//               "createSparkpostIntegrationFolder:" +
//                 JSON.stringify(response.data));
//                 console.log("create sparkpostIntegration Folder - SOAP URL:",response.data.soap_instance_url)
          
//             // if (response.data.statusText) {
//             //   thisdata.setState({ refreshtoken: response.data.refreshToken });
//             //   thisdata.setState({ FolderID: response.data.FolderID });
              
//             domainConfigurationDECheck(
//             check={
//                // refreshToken : response.data.refreshToken,
//                 soap_instance_url : response.data.soap_instance_url,
//                 //memberid : response.data.member_id,
//                 Folder_ID : response.data.FolderID
//             }
//               );
//             // } else {
//             //   console.log("Error creating data extension folder");
//             // }
//           })
//           .catch(function (error) {
//             console.log(error);
//           });
//       }

     
//   function domainConfigurationDECheck(check)
//  {
//   //  var dataextensionname = document.getElementById("txt").value;
//   //  console.log("dataextensionname=",dataextensionname);
//   //  console.log("methodcalled");
//   // console.log("World");
//   console.log("FolderID in DE:",JSON.stringify(check.Folder_ID));
//        axios({
//          method: "POST",
//          url: "/domainconfigurationde",
//          data: {
//           // dataextensionname : dataextensionname,
//           // memberid:check.memberid,
//            soap_instance_url: check.soap_instance_url,
//            Folder_ID : check.Folder_ID   
//          },
         
//        })
//          .then(function (response) {
//            console.log(
//              "DomainConfigurationDE:" + JSON.stringify(response)
//            );
//           //  document.getElementById("demo2").innerHTML = "dataextension created";
//           //  document.getElementById("demo4").innerHTML = JSON.stringify(response);
//            // if (response.data) {
           
//            //   thisdata.setState({
//            //     DEexternalKeyDomainConfiguration:
//            //       response.data.DEexternalKeyDomainConfiguration,
//            //   });
            
//            // } else {
//            //   console.log("Error creating data extension folder");
//            // }
//           //  dataFolderCheck(
//           //     thisdata,
//           //     response.data.refreshToken,
//           //     response.data.member_id,
//           //     response.data.rest_instance_url,
//           //     response.data.soap_instance_url
//           //   );
//          })
//          .catch(function (error) {
//           // document.getElementById("demo3").innerHTML = "dataextension not created";
//            console.log(error);
//          });
//      }   
  </script>
</body>
</html>
   
